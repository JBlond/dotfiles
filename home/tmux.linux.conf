# good practice: don't use different aliases for the same command
#   set  --> set-option
#   setw --> set-window-option
#   run  --> run-shell
#   bind --> bind-key
#       -r flag: enable keep hitting bind key without prefix
#       -n flag: enable bind key without prefix
#       -g flag: global
#       -T sets the client's key table; the next key from the client will be interpreted from key-table.

# enable mouse
set -g mouse on

# clipboard

# copy to X11 clipboard
if -b 'command -v xsel > /dev/null 2>&1' 'bind y run -b "tmux save-buffer - | xsel -i -b"'
if -b '! command -v xsel > /dev/null 2>&1 && command -v xclip > /dev/null 2>&1' 'bind y run -b "tmux save-buffer - | xclip -i -selection clipboard >/dev/null 2>&1"'

# ------ key bindings ---------------------------

# Switch to workspace via Alt + #.
# switch windows alt+number
bind-key -n M-1 select-window -t 1
bind-key -n M-2 select-window -t 2
bind-key -n M-3 select-window -t 3
bind-key -n M-4 select-window -t 4
bind-key -n M-5 select-window -t 5
bind-key -n M-6 select-window -t 6
bind-key -n M-7 select-window -t 7
bind-key -n M-8 select-window -t 8
bind-key -n M-9 select-window -t 9

# Sane pane splitting with Prefix + | and Prefix + -.
# The default ones are % and ", which is highly non-intuitive:
# Pane splitting.
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"

# Toggle pane synchronization with Prefix + S:
bind S set synchronize-panes

# switch panes using Alt-arrow without prefix
bind -n M-Left select-pane -L
bind -n M-Right select-pane -R
bind -n M-Up select-pane -U
bind -n M-Down select-pane -D

# Shift arrow to switch windows
# bind -n S-Left  previous-window
# bind -n S-Right next-window

## --- F KEYS
bind -T root F1 new-window
bind -T root F2 next-window
bind -T root F3 previous-window
bind -T root F4 kill-window
bind -T root F5 source-file ~/.tmux.conf \; display 'Reloaded tmux config.'
bind -T root F6 set status
bind -T root F7 new-session
bind -T root F8 detach
bind -T root F9 next-layout

# F11 = toogle mouse on and off
bind -T root F11set-option -w mouse\; set-option -g mouse

# allow F12 to burn off/on CRTL+B
bind -T root F12  \
    set prefix None \;\
    set key-table off \;\
    set status-style "fg=colour245, bg=colour238" \;\
    if -F '#{pane_in_mode}' 'send-keys -X cancel' \;\
    refresh-client -S \;\

bind -T off F12 \
    set -u prefix \;\
    set -u key-table \;\
    set -u status-style \;\
    set -u window-status-current-style \;\
    set -u window-status-current-format \;\
    refresh-client -S

# ------ windows settings ---------------------------
# rename-window
set -wg allow-rename off
set -wg automatic-rename off

# Automatically re-number windows after one of them is closed.
set -g renumber-windows on

# ------ status theme -------------------------------

# always use 256 colors
set -g default-terminal screen-256color
set -g terminal-overrides ',screen-256color:Tc'

# define some colors
COLOR_STATUS_FOREGROUND=colour255
COLOR_STATUS_BACKGROUND=colour238

# message colors
set -g message-style "bg=#00346e, fg=#ffffd7"  # tomorrow night blue, base3
# display for 2 seconds
set-option -g display-time 2000

set-option -g status-fg $COLOR_STATUS_FOREGROUND
set-option -g status-bg default
set-option -g status-style default

# status line refresh interval
set -g status-interval 1

# left
set -g status-left "#[fg=black,bg=colour214] ‚ùê #S #[bg=default] #[fg=black,bg=colour214][#I:#P]#[bg=default] "
set -g status-left-length 400

# right
set -g status-right "#[fg=black,bg=colour214] Date #[fg=brightwhite, bg=colour238] %Y-%m-%d %H:%M "
set -g status-right-length 600

set -wg window-status-separator " "

# last used window name
set -wg window-status-last-style "fg=white"

# default inactive window
set-window-option -g window-status-format '#[fg=colour214,bg=colour235] #I #[fg=white,bg=colour236] #W #[default]'

# current window
set-window-option -g window-status-current-style none
set-window-option -g window-status-current-format '#[fg=black,bg=colour214] #I #[fg=brightwhite,bg=colour238] #W #[default]'


# panes
# current pane is black the others light grey
# set -g window-style 'fg=colour247,bg=colour236'
# set -g window-active-style 'fg=colour250,bg=black'

set -wg pane-active-border-style "bg=default, fg=blue"
set -wg pane-border-style "fg=#585858" # base01
set-option -g display-panes-active-colour colour148
set-option -g pane-active-border-style "fg=colour255"


# clock color
set-window-option -g clock-mode-colour colour160

# Start window and pane indices at 1.
set -g base-index 1
set -g pane-base-index 1

# See if this fixes slow ESC issues.
# http://unix.stackexchange.com/questions/23138/esc-key-causes-a-small-delay-in-terminal-due-to-its-alt-behavior
set -s escape-time 0

# reload config file (change file location to your the tmux.conf you want to use)
bind r source-file ~/.tmux.conf \; display 'Reloaded tmux config.'

# set position to top
set-option -g status-position top

# enter copy mode. Then CTRL + SPACE for selection. CTRL + w to put the selection into the buffer
bind C-c copy-mode
bind C-v paste-buffer

# have command prompt not only on :
bind . command-prompt

bind + source ~/dotfiles/home/powerline.theme.tmux

# tmux-resurrect options
set -g @resurrect-capture-pane-contents 'on'
set -g @resurrect-save-shell-history 'off'
set -g @resurrect-processes 'ssh'

set -g @continuum-restore 'on'

set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
run '~/.tmux/plugins/tpm/tpm'

# THE END üò¢
